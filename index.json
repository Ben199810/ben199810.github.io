[{"content":"","date":"24 September 2023","externalUrl":null,"permalink":"/","section":"bing-wei's Blog","summary":"","title":"bing-wei's Blog","type":"page"},{"content":"","date":"24 September 2023","externalUrl":null,"permalink":"/tags/k8s/","section":"Tags","summary":"","title":"k8s","type":"tags"},{"content":"","date":"24 September 2023","externalUrl":null,"permalink":"/tags/m1/","section":"Tags","summary":"","title":"m1","type":"tags"},{"content":"","date":"24 September 2023","externalUrl":null,"permalink":"/tags/m2/","section":"Tags","summary":"","title":"m2","type":"tags"},{"content":"","date":"24 September 2023","externalUrl":null,"permalink":"/tags/mac/","section":"Tags","summary":"","title":"mac","type":"tags"},{"content":"","date":"24 September 2023","externalUrl":null,"permalink":"/tags/minikube/","section":"Tags","summary":"","title":"minikube","type":"tags"},{"content":" å‰è¨€ # æœ€è¿‘è¶è‘— BTS å­¸ç”Ÿæ•™è‚²æ–¹æ¡ˆå…¥æ‰‹äº† macbook pro m2 ç‰ˆæœ¬ï¼Œå› æ­¤ä¹Ÿæƒ³è¦åœ¨ä¸Šé¢å®‰è£ minikube ä¾†ç·´ç¿’ k8s çš„æ“ä½œã€‚ä½†åœ¨å®‰è£çš„éç¨‹ä¸­ï¼Œç™¼ç¾äº†ä¸€äº›å•é¡Œï¼Œå› æ­¤ç´€éŒ„ä¸€ä¸‹ã€‚\nå•é¡Œ # åœ¨å®‰è£çš„éç¨‹ä¸­ï¼Œç™¼ç¾ç›®å‰ vitrualbox é‚„ä¸æ”¯æ´ m1 èˆ‡ m2 ç‰ˆæœ¬çš„ macã€‚æ‰€ä»¥æ‰¾äº†å…¶ä»–çš„è™›æ“¬æ©Ÿè»Ÿé«”\nå…¶ä¸­ä¹Ÿæœ‰ä½¿ç”¨ hyperkit ä¾†å®‰è£çš„æ–¹å¼ã€‚ä½†ä¹Ÿæ˜¯ä¸è¡Œã€‚\nè§£æ±ºæ–¹æ¡ˆ # å¾Œä¾†æ‰¾åˆ° Qemu é€™å€‹è™›æ“¬æ©Ÿè»Ÿé«”ï¼Œé€™é‚Šç°¡å–®ä»‹ç´¹ã€‚\nQEMU æ˜¯ä¸€ç¨®æ¨¡æ“¬å™¨ï¼Œå®ƒèƒ½å¤ å®Œæˆä½¿ç”¨è€…ç¨‹å¼æ¨¡æ“¬å’Œç³»çµ±è™›æ“¬åŒ–æ¨¡æ“¬ï¼š\nä½¿ç”¨è€…ç¨‹å¼æ¨¡æ“¬ï¼šQEMU èƒ½å¤ å°‡ç‚ºä¸€å€‹å¹³å°ç·¨è­¯çš„äºŒé€²ä½æª”æ¡ˆé‹è¡Œåœ¨å¦ä¸€å€‹ä¸åŒçš„å¹³å°ã€‚ ç³»çµ±è™›æ“¬åŒ–æ¨¡æ“¬ï¼šQEMU èƒ½å¤ æ¨¡æ“¬ä¸€å€‹å®Œæ•´çš„ç³»çµ±è™›æ“¬æ©Ÿï¼Œè©²è™›æ“¬æ©Ÿæœ‰è‡ªå·±çš„è™›æ“¬CPUã€æ™¶ç‰‡çµ„ã€è™›æ“¬è¨˜æ†¶é«”ä»¥åŠå„ç¨®è™›æ“¬å¤–éƒ¨è¨­å‚™ï¼Œèƒ½å¤ ç‚ºè™›æ“¬æ©Ÿä¸­é‹è¡Œçš„ä½œæ¥­ç³»çµ±å’Œæ‡‰ç”¨è»Ÿé«”å‘ˆç¾å‡ºèˆ‡å¯¦é«”é›»è…¦å®Œå…¨ä¸€è‡´çš„ç¡¬é«”è¦–åœ–ã€‚QEMUèƒ½å¤ æ¨¡æ“¬ x86ã€ARMã€MIPSã€PPC ç­‰å¤šå€‹å¹³å°ã€‚ æ²’éŒ¯ï¼Œå¯èƒ½æœ‰è®€è€…ç™¼ç¾äº†é‡é»ï¼Œå› ç‚º m1 èˆ‡ m2 æ˜¯ ARM æ¶æ§‹ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ Qemu ä¾†æ¨¡æ“¬æˆ‘å€‘æ‰€éœ€è¦çš„ VM ç’°å¢ƒã€‚\nå®‰è£ # å…ˆå®‰è£ Qemu\nbrew install qemu æ¥è‘—è¨­å®š Qemu socket_vvmnet\nbrew install socket_vmnet brew tap homebrew/services HOMEBREW=$(which brew) \u0026amp;\u0026amp; sudo ${HOMEBREW} services start socket_vmnet å°±å¯ä»¥å•Ÿå‹•æˆ‘å€‘çš„ç’°å¢ƒå•¦ï¼\nminikube start --driver qemu --network socket_vmnet åƒè€ƒè³‡æ–™ # How to Setup Minikube on MAC M1/M2 ","date":"24 September 2023","externalUrl":null,"permalink":"/posts/minikube/install/apple/","section":"Posts","summary":"å‰è¨€ # æœ€è¿‘è¶è‘— BTS å­¸ç”Ÿæ•™è‚²æ–¹æ¡ˆå…¥æ‰‹äº† macbook pro m2 ç‰ˆæœ¬ï¼Œå› æ­¤ä¹Ÿæƒ³è¦åœ¨ä¸Šé¢å®‰è£ minikube ä¾†ç·´ç¿’ k8s çš„æ“ä½œã€‚ä½†åœ¨å®‰è£çš„éç¨‹ä¸­ï¼Œç™¼ç¾äº†ä¸€äº›å•é¡Œï¼Œå› æ­¤ç´€éŒ„ä¸€ä¸‹ã€‚","title":"minikube å®‰è£ for Mç³»åˆ—æ™¶ç‰‡ Mac","type":"posts"},{"content":"","date":"24 September 2023","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"24 September 2023","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"22 September 2023","externalUrl":null,"permalink":"/tags/cicd/","section":"Tags","summary":"","title":"cicd","type":"tags"},{"content":"","date":"22 September 2023","externalUrl":null,"permalink":"/tags/gitlab/","section":"Tags","summary":"","title":"gitlab","type":"tags"},{"content":" å‰è¨€ # æœ€è¿‘å› ç‚ºå…¬å¸æœ‰åœ¨é€²è¡Œ GitLab è½‰ç§»ï¼Œæ‰€ä»¥è¦é‡æ–°å»ºæ§‹ CICDï¼Œæä¾›æ¯”è¼ƒå¥½ç¶­è­·çš„ CI modulesï¼Œè®“æ‰€æœ‰çš„çµ„èƒ½å¤ é€šç”¨ï¼Œé”åˆ°æµç¨‹ç°¡åŒ–çš„ç›®çš„ã€‚æœ‰é–‹å§‹ç”¨ä¸€äº›æ¯”è¼ƒé€²éšçš„ CICD å¯«æ³•æ‰€ä»¥é€éå¯«ç­†è¨˜ï¼Œæå‡è‡ªå·±çš„å°è±¡ã€‚\næ¦‚å¿µ # ä½¿ç”¨ gitlab-ci å»ºç«‹çš„è‡ªå‹•åŒ–æµç¨‹ï¼Œç¨±ä½œ pipeline ä¸­æ–‡æ„æ€æ˜¯æµæ°´ç·šã€‚å°±åƒè¨­å®šå¥½ä¸€å€‹ç”Ÿç”¢ç·šä¸€æ¨£ååˆ†æœ‰è¶£ã€‚ é€™é‚Šå·²ç¶“çŸ¥é“äº† pipelineï¼Œé‚£ç”±èª°åŸ·è¡Œ pipeline çš„æµç¨‹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ gitlab runnerã€‚ç•¶æœ‰ pipeline è§¸ç™¼ä¸”éœ€è¦åŸ·è¡Œæ™‚ï¼Œæœƒæœ‰ job ç”¢ç”Ÿï¼Œé€™äº› job å°±æœƒåˆ†é…çµ¦ runner å»åŸ·è¡Œå›‰ï¼ åŸºç¤ CICD # äº†è§£æ¦‚å¿µä¹‹å¾Œï¼Œå°±å¯ä»¥é–‹å§‹å¯«è‡ªå·±çš„ CICD äº†ï¼é‚£ä¸€èˆ¬çš„ CICD æµç¨‹æ˜¯ä»€éº¼å‘¢ï¼Ÿä¸€èˆ¬ä¾†èªªæœƒæœ‰ä»¥ä¸‹åŸºæœ¬å…ƒç´ ï¼š\n1ï¸âƒ£ Stage\n2ï¸âƒ£ Job\n3ï¸âƒ£ Script\nå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ yaml æ˜¯ä¸€å€‹åŸºç¤çš„ pipeline ç¯„ä¾‹ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸‰å€‹ stageï¼Œåˆ†åˆ¥æ˜¯ buildã€testã€deployï¼Œæ¯å€‹ stage åº•ä¸‹éƒ½æœ‰ä¸€å€‹ jobï¼Œæ¯å€‹ job åº•ä¸‹éƒ½æœ‰ä¸€å€‹ scriptï¼Œé€™å€‹ script å°±æ˜¯è¦åŸ·è¡Œçš„æŒ‡ä»¤ã€‚\nç¯„ä¾‹ï¼š\nstages: - build - test - deploy build: stage: build script: # å®šç¾© build éšæ®µçš„æŒ‡ä»¤ - echo \u0026#34;Building the application\u0026#34; - docker build -t $IMAGE_NAME:$TAG . test: stage: test script: # å®šç¾© test éšæ®µçš„æŒ‡ä»¤ - echo \u0026#34;Running tests\u0026#34; deploy: stage: deploy script: # å®šç¾© deploy éšæ®µçš„æŒ‡ä»¤ - echo \u0026#34;Deploying to production\u0026#34; # åœ¨å¯¦éš›æƒ…æ³ä¸‹ï¼Œé€™è£¡å¯ä»¥æ˜¯éƒ¨ç½²åˆ° Kubernetesã€AWSã€GCP ç­‰çš„ç›¸æ‡‰æŒ‡ä»¤ # ä¹Ÿå¯ä»¥ä½¿ç”¨ Helm é€²è¡Œéƒ¨ç½² ","date":"22 September 2023","externalUrl":null,"permalink":"/posts/gitlab/cicd/","section":"Posts","summary":"å‰è¨€ # æœ€è¿‘å› ç‚ºå…¬å¸æœ‰åœ¨é€²è¡Œ GitLab è½‰ç§»ï¼Œæ‰€ä»¥è¦é‡æ–°å»ºæ§‹ CICDï¼Œæä¾›æ¯”è¼ƒå¥½ç¶­è­·çš„ CI modulesï¼Œè®“æ‰€æœ‰çš„çµ„èƒ½å¤ é€šç”¨ï¼Œé”åˆ°æµç¨‹ç°¡åŒ–çš„ç›®çš„ã€‚æœ‰é–‹å§‹ç”¨ä¸€äº›æ¯”è¼ƒé€²éšçš„ CICD å¯«æ³•æ‰€ä»¥é€éå¯«ç­†è¨˜ï¼Œæå‡è‡ªå·±çš„å°è±¡ã€‚","title":"GitLab CICD","type":"posts"},{"content":"","date":"17 September 2023","externalUrl":null,"permalink":"/tags/cni/","section":"Tags","summary":"","title":"cni","type":"tags"},{"content":" å‰è¨€ # æœ€è¿‘åœ¨å”åŠ©å…¬å¸å°ˆæ¡ˆè½‰é›²ç«¯æ¶æ§‹æ™‚ï¼Œç”±æ–¼æœå‹™åªèƒ½å•Ÿç”¨ä¸€å€‹ pod æä¾›ç·šä¸Šæœå‹™çš„é‹ä½œï¼Œå› æ­¤ä¹Ÿé¸æ“‡ä½¿ç”¨ statefulSet éƒ¨ç½²æœå‹™ï¼Œåœ¨é€™éç¨‹ä¸­ç™¼ç¾çš„å•é¡Œã€‚\näº‹ä»¶æµç¨‹ # RD åŒä»æ›´æ–°äº† code åˆ° gitLabï¼Œä¸¦æ²’æœ‰é †åˆ©çš„å®Œæˆ CICDã€‚åŸå› æ˜¯ statefulSet pod åœ¨é—œé–‰æ™‚ï¼Œåœç•™åœ¨ terminatingï¼Œé›–ç„¶ k8s æœ‰ terminationGracePeriodSecondsï¼Œä½†ç”±æ–¼æƒ…æ³ç‰¹æ®Šã€‚ç•¶ä¸‹çš„ terminationGracePeriodSeconds æ˜¯ 14400ï¼Œé•·é”å››å°æ™‚ã€‚\nå› ç·šä¸Šç·Šæ€¥çš„å•é¡Œï¼Œæ‰€ä»¥é‡å° terminating pod æ¡å–äº† kubectl delete pod [pod name] --grace-period=0 --forceã€‚ä¹‹å¾Œé‡æ–°å»ºç«‹çš„ pod å°±æœƒå‡ºç¾ä»¥ä¸‹çš„éŒ¯èª¤è¨Šæ¯ ğŸ‘‡\ncontainer veth name provided (eth0) already exists Google Support # å…¶å¯¦å‰é™£å­å·²ç¶“æœ‰éŒ¯èª¤å½±éŸ¿åˆ°é–‹ç™¼è·Ÿæ¸¬è©¦ç’°å¢ƒäº†ï¼Œç”±æ–¼é€™æ¬¡å½±éŸ¿åˆ°æ­£å¼ç’°å¢ƒã€‚æŠŠæ¡ˆä»¶å–®ç­‰ç´šæå‡è‡³ P1 ä¸¦è«‹ google å”åŠ©æŸ¥æ‰¾éŒ¯èª¤ç™¼ç”Ÿçš„åŸå› ã€‚\né€™æ¬¡æœƒç™¼ç”Ÿçš„ä¸Šè¿°éŒ¯èª¤çš„åŸå› ï¼Œç¶“é google å”åŠ©ä¸»è¦æ˜¯æ¨æ¸¬åœ¨ pod é€²å…¥é—œé–‰æµç¨‹æ™‚ï¼Œç”±æ–¼ terminationGracePeriodSeconds è¨­ç½®æ™‚é•·æœ‰å››å°æ™‚ï¼Œå°šè™•æ–¼ pod çš„ lifecycle é€™æ™‚å€™ï¼Œä½¿ç”¨ kubectl delete pod --force æœƒå°è‡´éš¨ç„¶ pod æ¶ˆå¤±äº†ï¼Œä½†æœ‰ container è¨­å®šæ®˜ç•™åœ¨ node ä¸Šï¼Œå¦‚æœæ­¤æ™‚æ–°çš„ pod é‡æ–°åœ¨åŒä¸€é¡† node ä¸Šé¢å•Ÿå‹•å°±æœƒé€ æˆæœ‰ç›¸åŒè¨­å®šã€‚\né›–ç„¶æ”¹æˆ deployment å¯ä»¥è¦é¿ï¼Œä½†ç›¸å°çš„æœƒæµªè²»ä¸€çµ„ IPï¼Œé•·ä¹…ä¸‹ä¾†ä¸€æ¨£æœƒæœ‰å•é¡Œã€‚æœ€é‡è¦çš„é‚„æ˜¯è¦è®“ pod çµæŸæ•´å€‹ lifecycle æ‰ä¸æœƒç”¢ç”Ÿå¾ŒçºŒçš„å•é¡Œã€‚\n","date":"17 September 2023","externalUrl":null,"permalink":"/journals/k8s/veth-name-provided-already-exists/","section":"Journals","summary":"å‰è¨€ # æœ€è¿‘åœ¨å”åŠ©å…¬å¸å°ˆæ¡ˆè½‰é›²ç«¯æ¶æ§‹æ™‚ï¼Œç”±æ–¼æœå‹™åªèƒ½å•Ÿç”¨ä¸€å€‹ pod æä¾›ç·šä¸Šæœå‹™çš„é‹ä½œï¼Œå› æ­¤ä¹Ÿé¸æ“‡ä½¿ç”¨ statefulSet éƒ¨ç½²æœå‹™ï¼Œåœ¨é€™éç¨‹ä¸­ç™¼ç¾çš„å•é¡Œã€‚","title":"container veth name provided (eth0) already exists æ•…éšœæ’é™¤","type":"journals"},{"content":"","date":"17 September 2023","externalUrl":null,"permalink":"/journals/","section":"Journals","summary":"","title":"Journals","type":"journals"},{"content":"","date":"17 September 2023","externalUrl":null,"permalink":"/tags/node/","section":"Tags","summary":"","title":"node","type":"tags"},{"content":"","date":"17 September 2023","externalUrl":null,"permalink":"/tags/pod/","section":"Tags","summary":"","title":"pod","type":"tags"},{"content":"","date":"27 August 2023","externalUrl":null,"permalink":"/tags/docker/","section":"Tags","summary":"","title":"docker","type":"tags"},{"content":" å‰è¨€ # docker æ˜¯å°‡ image ä¿—ç¨±æ˜ åƒæˆ–è€…é¡åƒæª”ï¼Œå»ºç«‹å®¹å™¨çš„æ¨¡æ“¬ä½¿ç”¨ç’°å¢ƒçš„æŠ€è¡“ã€‚é‚£è¦å¦‚ä½•å»ºç«‹ image å‘¢ï¼Ÿ\næ¥è‘—ä»‹ç´¹æœ¬ç¯‡æ–‡ç« çš„é‡é» Dockerfile\nDockerfile # Dockfile æ˜¯ä¸€å€‹å»ºæ§‹ image çš„è…³æœ¬ï¼ŒåŸºæ–¼ä½ é¸æ“‡çš„åŸºåº•æ˜ åƒï¼Œé–‹å§‹å®‰è£åœ¨é–‹ç™¼ç’°å¢ƒæ‰€éœ€è¦çš„ä¾è³´ä»¥åŠå¥—ä»¶ç­‰ç­‰\u0026hellip;\nå»ºç«‹ image ä¹Ÿå¯ä»¥ä¿è­‰æ¯å€‹é–‹ç™¼è€…åœ¨é€²è¡Œé–‹ç™¼æ™‚ä½¿ç”¨çš„ç’°å¢ƒéƒ½ç›¸åŒï¼Œä¸æœƒå°è‡´å°‡ç¨‹å¼ç¢¼æ¨ä¸Šå»ç‰ˆæ§ï¼Œç¶“éæ‰“åŒ…ç™¼å¸ƒæ‰ç™¼ç¾æœ‰ç›¸å®¹æ€§çš„å•é¡Œã€‚æœ‰æ•ˆçš„æ¶ˆé™¤äº†åœ¨å”åŒé–‹ç™¼æ™‚æœƒé‡åˆ°çš„è¡çªå‘¢ï½\nä¸‹é¢æä¾›ç°¡å–®çš„ dockerfile ç¯„ä¾‹ã€‚ä¸‹é¢çš„ç¯„ä¾‹æ­¥é©Ÿä½¿ç”¨å¼•ç”¨ alpine image ç•¶åšåŸºåº•ï¼Œä¸¦ä¸”å®‰è£ curl å¥—ä»¶ã€‚ä»¥ image å•Ÿå‹• container æ™‚ï¼ŒæœƒåŸ·è¡Œ /bin/bashã€‚ ğŸ‘‰ docker run -it [image] /bin/bash\n# image åŸºåº• FROM alpine # å®‰è£å¥—ä»¶æˆ–åŸ·è¡Œçš„ shell RUN apk add curl CMD [\u0026#34;/bin/bash\u0026#34;] ","date":"27 August 2023","externalUrl":null,"permalink":"/posts/docker/dockerfile/","section":"Posts","summary":"å‰è¨€ # docker æ˜¯å°‡ image ä¿—ç¨±æ˜ åƒæˆ–è€…é¡åƒæª”ï¼Œå»ºç«‹å®¹å™¨çš„æ¨¡æ“¬ä½¿ç”¨ç’°å¢ƒçš„æŠ€è¡“ã€‚é‚£è¦å¦‚ä½•å»ºç«‹ image å‘¢ï¼Ÿ","title":"Dockerfile","type":"posts"},{"content":"","date":"19 August 2023","externalUrl":null,"permalink":"/tags/ingress/","section":"Tags","summary":"","title":"ingress","type":"tags"},{"content":" å‰è¨€ # éš¨è‘—ç³»çµ±æ¶æ§‹å¯èƒ½æ—¥ç›Šé¾å¤§ï¼Œå¯èƒ½æœƒä½¿ç”¨è¤‡æ•¸çš„ ingress ä¾†åšé€²å…¥æœå‹™çš„å€åˆ†ã€‚ä»¥é˜²æ­¢åœ¨ ingress ç•°å¸¸çš„æ™‚å€™ï¼Œæœƒå½±éŸ¿å…¨é«”çš„æœå‹™ä½¿ç”¨ã€‚ç¼ºé»æ˜¯è¤‡æ•¸çš„ ingress éœ€è¦ä½¿ç”¨éœæ…‹ IPã€‚åœ¨ GCP çš„æœå‹™ä¸Šï¼Œæ¯ä¿ç•™ä¸€çµ„éœæ…‹ IP æœå‹™å°±æ˜¯å¢åŠ æˆæœ¬ã€‚æ¥è‘—æœƒä»‹ç´¹ ingress controller é€™é …æœå‹™ç”¨æ–¼ç®¡ç†æ‰€æœ‰çš„ ingressã€‚\nä¸Šä¸€ç¯‡æ–‡ç« ä¸­æœ‰æåˆ° ingressï¼Œå¦‚æœæƒ³ç­è§£ ingress å¯ä»¥å…ˆåƒè€ƒæˆ–é ç¿’é€™ç¯‡æ–‡ç« ã€‚ Ingress 6 August 2023\u0026middot;1 åˆ†é˜ k8s ingress Nginx Ingress Controller # é€™ç¯‡æ–‡ç« è¦è¬›è§£çš„ Nginx Ingress Controller çµåˆäº† Ingress çš„ç°¡æ½”ä¸¦æ”¯æ´ Nginx ç›¸é—œçš„æ“´å……åŠŸèƒ½ï¼Œè®“æˆ‘å€‘èƒ½æ›´å¥½çš„ç®¡ç†æ‰€æœ‰çš„ ingressï¼Œä¸‹é¢æœƒç°¡å–®æåˆ° nginx ä»¥åŠ ingress å„ªé»ã€‚\nNginx ä»‹ç´¹ # nginx æ˜¯ä¸€æ¬¾é«˜æ•ˆèƒ½ã€è€ç”¨ã€ä¸”åŠŸèƒ½å¼·å¤§çš„ loadBalance åŠ webServerã€‚ä¹Ÿæ“æœ‰å¾ˆé«˜çš„å¸‚ä½”ç‡ã€‚\né«˜æ•ˆèƒ½çš„ webServer é å‹å‚³çµ± apache server çš„è³‡æºèˆ‡æ•ˆèƒ½ å¤§é‡çš„æ¨¡çµ„èˆ‡æ“´å……åŠŸèƒ½ å……è¶³çš„å®‰å…¨æ€§åŠŸèƒ½ è¼•é‡ å®¹æ˜“æ°´å¹³æ“´å±• Ingress ä»‹ç´¹ # å®šç¾©å¤–éƒ¨åˆ°å…§éƒ¨çš„è¨­å®šã€‚\nService é€£æ¥ LoadBalance è¨­å®š SSL/TLS çµ‚ç«¯ è™›æ“¬ä¸»æ©Ÿè¨­å®š å®‰è£ # ä½¿ç”¨ Helm ä¾†å®‰è£ Ingress Controller helm upgrade --install ingress-nginx ingress-nginx \\ --repo https://kubernetes.github.io/ingress-nginx \\ --namespace ingress-nginx --create-namespace values # ä½¿ç”¨ Helm é€²è¡Œå®‰è£ï¼Œéœ€è¦åšèª¿æ•´ï¼Œä¸¦æƒ³è¦åƒè€ƒæœ‰å“ªäº›å€¼æ˜¯å¯æä¾›ä½¿ç”¨è€…èª¿æ•´ã€‚å¯ä»¥ä½¿ç”¨ä¸‹åˆ—çš„æŒ‡ä»¤è¼¸å‡º values.yamlã€‚\næˆ–è€…åˆ° Github ä¸Šé–±è®€æ•´å€‹æœå‹™çš„æ˜¯å¦‚ä½•é‹ä½œè·Ÿå»ºç«‹çš„\nhelm show values ingress-nginx --repo https://kubernetes.github.io/ingress-nginx ","date":"19 August 2023","externalUrl":null,"permalink":"/posts/k8s/ingress-controller/","section":"Posts","summary":"å‰è¨€ # éš¨è‘—ç³»çµ±æ¶æ§‹å¯èƒ½æ—¥ç›Šé¾å¤§ï¼Œå¯èƒ½æœƒä½¿ç”¨è¤‡æ•¸çš„ ingress ä¾†åšé€²å…¥æœå‹™çš„å€åˆ†ã€‚ä»¥é˜²æ­¢åœ¨ ingress ç•°å¸¸çš„æ™‚å€™ï¼Œæœƒå½±éŸ¿å…¨é«”çš„æœå‹™ä½¿ç”¨ã€‚ç¼ºé»æ˜¯è¤‡æ•¸çš„ ingress éœ€è¦ä½¿ç”¨éœæ…‹ IPã€‚åœ¨ GCP çš„æœå‹™ä¸Šï¼Œæ¯ä¿ç•™ä¸€çµ„éœæ…‹ IP æœå‹™å°±æ˜¯å¢åŠ æˆæœ¬ã€‚æ¥è‘—æœƒä»‹ç´¹ ingress controller é€™é …æœå‹™ç”¨æ–¼ç®¡ç†æ‰€æœ‰çš„ ingressã€‚","title":"Ingress Controller ç°¡ä»‹","type":"posts"},{"content":" ä»‹ç´¹ ingress # ingress æ˜¯ k8s çµ¦ service æä¾›å¤–éƒ¨è¨ªå•çš„ URLã€SSLã€è·¯ç”±ç­‰åŠŸèƒ½ã€‚ å¯ä»¥ç†è§£ç‚º nginx æˆ– traefik ç­‰çš„ä»£ç†å·¥å…·ã€‚å…è¨±é€éæŸå€‹ URL é€²å…¥å°æ‡‰çš„ serviceï¼Œä¸”ç¢°åˆ°æŸäº› route èƒ½å¤  proxy pass åˆ°å…¶ä»– serviceã€‚\nâ­ ingress åˆåˆ†æˆå¤–éƒ¨è² è¼‰å¹³è¡¡ã€å…§éƒ¨è² è¼‰å¹³è¡¡ã€‚å…©è€…åœ¨ä½¿ç”¨è¨­å®šä¸Šæœ‰ä¸€äº›å°å°çš„ä¸åŒã€‚\nå¤–éƒ¨è² è¼‰å¹³è¡¡ # é€šå¸¸å°å¤–éƒ¨çš„è² è¼‰å¹³è¡¡å…¥å£ï¼Œéƒ½æœƒè¨­ç½®é˜²ç«ç‰†æˆ–æ˜¯ç™½åå–®ç®¡ç†ä½†æ˜¯ k8s ingress å»ä¸èƒ½ç›´æ¥å¯¦ç¾ã€‚éœ€è¦é€éä¸€äº› gcp å…ƒä»¶åŠŸèƒ½ï¼Œä¾†è¨­ç½®é˜²ç«ç‰†æˆ–ç™½åå–®ç®¡ç†ã€‚\ncloud armor # armor çš„ç¿»è­¯æ˜¯æŒ‡ç›”ç”²çš„æ„æ€ï¼Œé€™æ˜¯ç”± gcp æä¾›çš„æœå‹™ï¼Œå…·æœ‰åˆ†æ•£å¼é˜»æ–·æ”»æ“Š(DDos)é˜²è­·æ©Ÿåˆ¶ã€ç¶²è·¯æ‡‰ç”¨ç¨‹å¼é˜²ç«ç‰†ã€‚å¯ä»¥æ­é… loadBalanceã€Cloud CDN ä¾†å¼·åŒ–ç¶²è·¯å®‰å…¨æœå‹™ã€‚\né‚£éº¼æˆ‘å€‘è¦å¦‚ä½•å°‡ cloud armor æ‡‰ç”¨åœ¨æˆ‘å€‘ ingress ä¸Šé¢å‘¢ï¼Ÿæ¥è‘—çœ‹ä¸‹å» ğŸ˜\né¦–å…ˆæˆ‘å€‘å¯ä»¥å…ˆæ‰¾å®˜æ–¹çš„ä½¿ç”¨æ‰‹å†Š Configuring Ingress using the default controller æ¥è‘—å°‡é‡é»æ”¾åœ¨ backendConfig è¨­å®šä¸Šé¢ï¼Œå‰é¢çš„ä»‹ç´¹å·²ç¶“çŸ¥é“ ingress è² è²¬ä¾æ“šè·¯ç”±è¦å‰‡ä»£ç†è½‰ç™¼ã€‚æ–‡ä»¶ä¸Š backenConfig èˆ‡ service å¯ä»¥è€¦åˆã€‚ä½¿ç”¨ backendConfig çš„è¨­å®šã€‚\nBackendConfig and FrontendConfig overview è©³ç´°æƒ³çŸ¥é“ backendConfig è¨­å®šç¯„ä¾‹å¯ä»¥åœ¨æ–‡ä»¶é€£æ¥å…§æ‰¾åˆ° ğŸ‘‰ Configuring Ingress features through BackendConfig parameters æ¥è‘—ä¸‹é¢ç¹ªè£½ä¸€å¼µå¤–éƒ¨è² è¼‰å¹³è¡¡çš„æ¶æ§‹åœ–ã€‚å¯ä»¥çœ‹åˆ°ä¸‹åœ–ä¸­ 114.1.46.157 çš„å®¢æˆ¶ç«¯åœ¨è¨ªå•çš„æ™‚å€™è¢« ingress çµ¦æ“‹ä¸‹äº†ã€‚\nåŸå› æ˜¯ ingress å¾Œç«¯ service æœ‰è€¦åˆ backendConfigï¼Œé€é backendConfig ä½¿ç”¨äº† cloud armorã€‚\nflowchart LR cli1(client 34.41.26.173) cli2(client 114.1.46.157) cli1 --\u003e ing cli2 --x ing subgraph k8s-cluster ing((ingress)) svc-web(web-service) svc-api(api-service) df-backend(backend-config) armor{{cloud-armor}} ing --\u003e svc-web ing --\u003e svc-api armor -.- df-backend df-backend -.-\u003e svc-web df-backend -.-\u003e svc-api end å…§éƒ¨è² è¼‰å¹³è¡¡ # è¬›å®Œäº†å¤–éƒ¨è² è¼‰å¹³è¡¡ï¼Œæ¥è‘—è¬› ingress æ“”ä»»å…§éƒ¨è² è¼‰å¹³è¡¡æ™‚ï¼Œéœ€è¦æ³¨æ„çš„äº‹é …ã€‚\nNetwork endpoint group # ä»€éº¼æ˜¯ NEG ?\nNEG æ˜¯æŒ‡ Network endpoint groupï¼Œæ˜¯ä¸€ç¨®é…ç½®ã€‚æ„æ€æ˜¯æŒ‡å®šä¸€çµ„å¾Œç«¯ endpoint æˆ– serviceï¼Œå€ŸåŠ©NEGï¼ŒGoogle Cloud è² è¼‰å‡è¡¡å™¨å¯ä»¥ç‚ºåŸºæ–¼ GCE çš„å·¥ä½œè² è¼‰ã€ç„¡æœå‹™å™¨å·¥ä½œè² è¼‰å’Œå®¹å™¨åŒ–å·¥ä½œè² è¼‰æä¾›æœå‹™ã€‚å¯ä»¥æ›´ç²¾ç´°çš„å°‡æµé‡åˆ†é…åˆ°è² è¼‰å‡è¡¡å™¨çš„å¾Œç«¯ã€‚\nä½¿ç”¨æ™‚ï¼Œå°å¾Œç«¯çš„ service å¿…é ˆè¦ä½¿ç”¨ NEGï¼Œè©³ç´°æƒ³è¦äº†è§£å¯ä»¥åƒè€ƒ ğŸ‘‰ Network endpoint groups overview ","date":"6 August 2023","externalUrl":null,"permalink":"/posts/k8s/ingress/","section":"Posts","summary":"ä»‹ç´¹ ingress # ingress æ˜¯ k8s çµ¦ service æä¾›å¤–éƒ¨è¨ªå•çš„ URLã€SSLã€è·¯ç”±ç­‰åŠŸèƒ½ã€‚ å¯ä»¥ç†è§£ç‚º nginx æˆ– traefik ç­‰çš„ä»£ç†å·¥å…·ã€‚å…è¨±é€éæŸå€‹ URL é€²å…¥å°æ‡‰çš„ serviceï¼Œä¸”ç¢°åˆ°æŸäº› route èƒ½å¤  proxy pass åˆ°å…¶ä»– serviceã€‚","title":"Ingress","type":"posts"},{"content":" åŒ¯å‡º/å…¥æ˜ åƒæª” # â­ export å¯ä»¥åŒ¯å‡º container å·²è®Šæ›´çš„è¨­å®š\nâ­ save å–®ç´”åŒ¯å‡º image\nâ­ é€™è£¡è¦æ³¨æ„ export å°æ‡‰ import ; save å°æ‡‰ load\ndocker export [image] \u0026gt; [filename].tar docker import \u0026lt; [filname].tar docker save [image]:[tag] \u0026gt; [filname].tar docker load \u0026lt; [filname].tar åœ¨å®¹å™¨è£¡åŸ·è¡Œæ‡‰ç”¨ç¨‹åº # â­ docker startã€stopã€restart\ndocker run [image] /bin/echo \u0026#34;Hello world\u0026#34; èˆ‡å®¹å™¨é€²è¡Œäº¤äº’ # -tï¼šçµ‚ç«¯æ©Ÿ -iï¼šå‡†è¨±ä½ èˆ‡å®¹å™¨äº¤äº’ -dï¼šåœ¨èƒŒæ™¯åŸ·è¡Œ exit æˆ– ctrl+dï¼šé›¢é–‹å®¹å™¨ docker run -i -t [image] /bin/bash åœ¨å®¹å™¨è£¡æŸ¥çœ‹ç•¶å‰ç³»çµ±ç‰ˆæœ¬ä¿¡æ¯ã€‚ # cat /proc/version æŸ¥çœ‹é‹è¡Œçš„å®¹å™¨ # -aï¼šé¡¯ç¤ºæ‰€æœ‰å®¹å™¨ docker ps æŸ¥çœ‹å®¹å™¨å…§çš„æ¨™æº–è¼¸å‡º # -fï¼šæŒçºŒæŸ¥çœ‹ docker logs [container] é€²å…¥å®¹å™¨ # â­ å¦‚æœä½¿ç”¨ attach é€²å…¥å®¹å™¨ï¼Œé€€å‡ºæ™‚æœƒå°è‡´å®¹å™¨åœæ­¢\ndocker attach [container] docker exec -it [container] /bin/bash æŸ¥çœ‹ image ã€ container è©³ç´°å¤§å°ã€‚ # docker system df -v æŸ¥çœ‹å®¹å™¨å•Ÿå‹•é€²ç¨‹ # docker top [container] container è³‡æºä½¿ç”¨ç‹€æ³ # docker stats docker-compose é‡å°ç‰¹å®šå®¹å™¨é‡å•Ÿ # docker-compose up --detach --build [service_name] docker æ¸…ç†æŠ€å·§ # æ¸…ç† Docker çš„ containerï¼Œimage èˆ‡ volume â­ pruneæ“ä½œæ˜¯æ‰¹é‡åˆªé™¤é¡çš„å±éšªæ“ä½œï¼Œä½¿ç”¨ y ç¢ºèªã€‚ä¸æƒ³è¦è¼¸å…¥å¯ä»¥æ·»åŠ  -fï¼Œæ…ç”¨!\næ¸…é™¤æ‰€æœ‰åœæ­¢é‹è¡Œçš„å®¹å™¨ # docker container prune æ¸…ç†æ‰€æœ‰ image # docker image prune æ¸…ç†æœªä½¿ç”¨çš„ image # docker image prune -a æ¸…ç†æ‰€æœ‰ç„¡ç”¨çš„ volumes # docker volume prune Dcokerfile èˆ‡ Docker-compose # Day14 Dockerfile \u0026amp; Docker-Compose å° Docker Image åšåç·¨è­¯æˆ Dockerfile # æ²’æœ‰å‘½ä»¤ç›´æ¥é€šé image å°±èƒ½åç·¨è­¯ï¼Œç²å¾— Dockerfile\nä½†æ˜¯æˆ‘å€‘å¯ä»¥ä½¿ç”¨ docker history å‘½ä»¤ï¼Œé€²è¡Œåæ¨\n--formatï¼šè‡ªå®šç¾©è¼¸å‡ºæ ¼å¼ --no-truncï¼šCREATED BY åˆ—å®Œæ•´é¡¯ç¤º ä½¿ç”¨ history\ndocker history [image:tag] docker history [image:tag] --format \u0026#34;table {{.ID}}\\t{{.CreatedBy}}\u0026#34; --no-trunc ","date":"30 July 2023","externalUrl":null,"permalink":"/posts/docker/command/","section":"Posts","summary":"åŒ¯å‡º/å…¥æ˜ åƒæª” # â­ export å¯ä»¥åŒ¯å‡º container å·²è®Šæ›´çš„è¨­å®š","title":"Docker æŒ‡ä»¤","type":"posts"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]